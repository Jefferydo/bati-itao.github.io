
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>live WET alerts using the hidden attribute</title>
	<link rel="stylesheet" href="https://www.canada.ca/etc/designs/canada/cdts/gcweb/v4_0_45/wet-boew/css/theme.min.css">
    <style>
      body { margin: 2em 10% 4em}
      body > div { margin-left: 2rem;}
      body > div > h3 { margin: 4rem 0 2rem -2rem;}
      .fa-bug, .fa-bomb { color: red;}
      .fa-circle-check { color: green;}
    </style>
    <script src="https://kit.fontawesome.com/27885d2ef5.js" crossorigin="anonymous"></script>
    <script>
        window.onload = function() {
        let sections = document.querySelectorAll("[id^=alert]");
        let toggleButtons = document.querySelectorAll("[id^=toggle]");

        for (let i = 0; i < sections.length; i++) {
            toggleButtons[i].addEventListener("click", function() {
            sections[i].hidden = !sections[i].hidden;
            });
        }
        };
      </script>
      
  </head>
  <body>

    <h1>Test: Live WET alerts toggling the HTML "hidden" attribute</h1>

    <p><a href="http://www.google.com">Focusable link</a></p>

    <p>All use the HTML technique of toggling the "hidden" attribute to simulate JS injecting element and text into a live region.</p>

    <p>This method works better in Firefox than CSS hiding:</p>
    <ul>
        <li>JAWS: Firefox passes tests 4, 5 and 6.</li>
        <li>NVDA: Firefox passes test 1</li>
    </ul> 

    <p>There's no change in Chrome or Edge compared to CSS hiding.</p>

    <div>
      <h3>Test 1: role=alert, aria-label=Danger</h3>
      <button id="toggle1">Trigger a live alert 1</button>

      <div role="alert" aria-atomic="true" aria-label="Danger">
        <section class="alert alert-danger" id="alert1" hidden>
          <h4 tabindex="-1">Are you sure you want to press the shiny red button?</h4>
          <p>There's no going back!</p>
        </section>
      </div>

      <h4>JAWS</h4>
      <p><i class="fa-solid fa-circle-check"></i> Firefox works as expected!</p>
      <p><i class="fa-solid fa-bug"></i> Chrome doesn't declare role</p>
      <p><i class="fa-solid fa-bug"></i> Edge doesn't declare role</p>

      <h4>NVDA</h4>
      <p><i class="fa-solid fa-circle-check"></i> Firefox works as expected! It even declares "heading level four."</p>
      <p><i class="fa-solid fa-bug"></i> Chrome doesn't declare the role.</p>
      <p><i class="fa-solid fa-bug"></i> Edge doesn't declare the role.</p>

    </div>
    
    <div>
      <h3>Test 2: role=alert, hidden heading prefix "Danger"</h3>
      <button id="toggle2">Trigger a live alert 2</button>

    <div role="alert" aria-atomic="true">
      <section class="alert alert-danger" id="alert2" hidden>
        <h4 tabindex="-1"><span class="wb-inv">Danger: </span>Are you sure you want to press the shiny red button?</h4>
        <p>There's no going back!</p>
      </section>
    </div>

      <h4>JAWS</h4>
      <p><i class="fa-solid fa-circle-check"></i> Firefox works as expected!</p>
      <p><i class="fa-solid fa-bug"></i> Chrome doesn't declare the role.</p>
      <p><i class="fa-solid fa-bug"></i> Edge doesn't declare the role.</p>

      <h4>NVDA</h4>
      <p><i class="fa-solid fa-bug"></i> <i class="fa-solid fa-bomb"></i> Firefox doesn't declare the heading unless you assign it tabindex="-1"; 
        however, it reads the heading after the paragraph: "Alert. There's no going back! Danger: Are you sure ..."</p>
      <p><i class="fa-solid fa-bug"></i> Chrome doesn't declare the role.</p>
      <p><i class="fa-solid fa-bug"></i> Edge doesn't declare the role.</p>

    </div>

    <div>
      <h3>Test 3: role=alert, aria-roledescription="Danger alert"</h3>
      <button id="toggle3">Trigger a live alert 3</button>

      <div role="alert" aria-atomic="true" aria-roledescription="Danger alert">
        <section class="alert alert-danger" id="alert3" hidden>
          <h4 tabindex="-1">Are you sure you want to press the shiny red button?</h4>
          <p>There's no going back!</p>
        </section>
      </div>

      <h4>JAWS</h4>
      <p><i class="fa-solid fa-bug"></i> Firefox doesn't declare the aria-roledescription.</p>
      <p><i class="fa-solid fa-bug"></i> Chrome doesn't declare the role or the aria-roledescription.</p>
      <p><i class="fa-solid fa-bug"></i> Edge doesn't declare the role or the aria-roledescription.</p>

      <h4>NVDA</h4>
      <p><i class="fa-solid fa-bug"></i> <i class="fa-solid fa-bomb"></i> Firefox doesn't declare the role or the heading. Setting tabindex works as above.</p>
      <p><i class="fa-solid fa-bug"></i> Chrome doesn't declare the role or aria-roledescription</p>
      <p><i class="fa-solid fa-bug"></i> Edge doesn't declare the role or aria-roledescription</p>

    </div>
  
    <div>
      <h3>Test 4: role=status, hidden heading prefix "Success alert:"</h3>
      <button id="toggle4">Trigger a live status</button>

      <!-- Tried a live container in case it makes a dif -->
      <div role="status" aria-atomic="true">
        <section class="alert alert-success" id="alert4" hidden>
          <h4><span class="wb-inv">Success alert: </span>Your profile was updated.</h4>
          <p>Time for coffee.</p>
        </section>
      </div>

      <h4>JAWS</h4>
      <p><i class="fa-solid fa-circle-check"></i> Firefox works as expected!</p>
      <p><i class="fa-solid fa-circle-check"></i> Chrome works as expected!</p>
      <p><i class="fa-solid fa-circle-check"></i> Edge works as expected!</p>
    
      <h4>NVDA</h4>
      <p><i class="fa-solid fa-circle-check"></i> Firefox works as expected!</p>
      <p><i class="fa-solid fa-circle-check"></i> Chrome works as expected!</p>
      <p><i class="fa-solid fa-circle-check"></i> Edge works as expected!</p>
    </div>
  
      
    <div>
      <h3>Test 5: aria-live=assertive, aria-atomic=true, hidden heading prefix "Success alert:"</h3>
      <button id="toggle5">Trigger aria-live assertive</button>

      <div aria-live="assertive" aria-atomic="true">
        <section class="alert alert-success" id="alert5" hidden>
          <h4><span class="wb-inv">Success alert: </span>Your profile was updated.</h4>
          <p>Time for coffee.</p>
        </section>
      </div>

      <h4>JAWS</h4>
      <p><i class="fa-solid fa-circle-check"></i> Firefox works as expected!</p>
      <p><i class="fa-solid fa-circle-check"></i> Chrome works as expected!</p>
      <p><i class="fa-solid fa-circle-check"></i> Edge works as expected!</p>
    
      <h4>NVDA</h4>
      <p><i class="fa-solid fa-circle-check"></i> Firefox works as expected!</p>
      <p><i class="fa-solid fa-circle-check"></i> Chrome works as expected!</p>
      <p><i class="fa-solid fa-circle-check"></i> Edge works as expected!</p>
    </div>  
      
    <div>
      <h3>Test 6: aria-live=polite, aria-atomic=true, hidden heading prefix "Success alert:"</h3>
      <button id="toggle6">Trigger aria-live polite</button>

      <div aria-live="polite" aria-atomic="true">
        <section class="alert alert-success" id="alert6" hidden>
          <h4><span class="wb-inv">Success alert: </span>Your profile was updated.</h4>
          <p>Time for coffee.</p>
        </section>
      </div>

      <h4>JAWS</h4>
      <p><i class="fa-solid fa-circle-check"></i> Firefox works as expected!</p>
      <p><i class="fa-solid fa-circle-check"></i> Chrome works as expected!</p>
      <p><i class="fa-solid fa-circle-check"></i> Edge works as expected!</p>
    
      <h4>NVDA</h4>
      <p><i class="fa-solid fa-circle-check"></i> Firefox works as expected!</p>
      <p><i class="fa-solid fa-circle-check"></i> Chrome works as expected!</p>
      <p><i class="fa-solid fa-circle-check"></i> Edge works as expected!</p>
    </div>

  </body>
</html>